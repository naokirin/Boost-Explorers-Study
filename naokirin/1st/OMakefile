SRCS = src/stack.hpp src/queue.hpp
TESTSRCS = test/stack_test.cpp test/queue_test.cpp
GTEST_DIR = c:/gtest-1.5.0
CXXFLAGS = -g -Wall -std=gnu++0x  -I$(GTEST_DIR)/include -I$(GTEST_DIR)
TARGET = bin/test.exe
OBJS = src/stack.o src/queue.hpp
TESTOBJS = test/stack_test.o test/stack_test.o
TESTXML = test_detail.xml
CXX = g++

.PHONY:$(TESTXML) clean

test: $(TARGET)
	$(TARGET)

$(TESTXML):$(TARGET)
	$(TARGET) --gtest_output="xml"

clean: 
	rm -f $(TARGET) $(TESTXML) *.gcno *.gcda *.gcov src/*.gch test/*.gch test/*.gcno

$(TARGET): 
	$(CXX) $(CXXFLAGS) -fprofile-arcs -ftest-coverage -lgcov -lpthread gtest_main.a $(SRCS) $(TESTSRCS) -o $(TARGET)

.DEFAULT:clean $(TARGET) $(TESTXML)
